<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cape Coral Home Retreat - Guest Portal</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #F0F9FF 0%, #E0F2FE 100%);
            min-height: 100vh;
        }
        .nav {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 20px;
            box-shadow: 0 4px 20px rgba(0,180,216,0.1);
            border-left: 6px solid #00B4D8;
        }
        .content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(245,158,11,0.1);
            border-left: 6px solid #F77F00;
        }
        .btn {
            background: linear-gradient(135deg, #00B4D8, #0096C7);
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            margin: 5px;
            cursor: pointer;
            border-bottom: 4px solid #F77F00;
            font-weight: 600;
            transition: all 0.2s ease;
            font-size: 14px;
        }
        .btn:hover {
            background: linear-gradient(135deg, #0096C7, #0077B6);
            transform: translateY(-1px);
        }
        .btn:active {
            transform: translateY(0);
        }
        .btn.active {
            background: linear-gradient(135deg, #0077B6, #023E8A);
            border-bottom-color: #D97706;
        }
        .btn-danger {
            background: linear-gradient(135deg, #EF4444, #DC2626);
            border-bottom-color: #B91C1C;
        }
        .btn-danger:hover {
            background: linear-gradient(135deg, #DC2626, #B91C1C);
        }
        .btn-success {
            background: linear-gradient(135deg, #10B981, #059669);
            border-bottom-color: #047857;
        }
        .btn-success:hover {
            background: linear-gradient(135deg, #059669, #047857);
        }
        .card {
            background: linear-gradient(135deg, #F8FAFC, #F1F5F9);
            padding: 24px;
            margin: 20px 0;
            border-radius: 12px;
            border-left: 5px solid #00B4D8;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        .admin-card {
            background: linear-gradient(135deg, #FEF3C7, #FDE68A);
            border-left-color: #F59E0B;
        }
        .emergency-card {
            background: linear-gradient(135deg, #FEF2F2, #FECACA);
            border-left-color: #EF4444;
        }
        .attraction-card {
            background: linear-gradient(135deg, #FFFBEB, #FEF3C7);
            border-left-color: #F77F00;
            transition: all 0.2s ease;
        }
        .attraction-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(247,127,0,0.2);
        }
        h1, h2, h3 {
            color: #1F2937;
        }
        .phone-link {
            color: #00B4D8;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.2s ease;
        }
        .phone-link:hover {
            color: #0096C7;
        }
        .form-group {
            margin: 20px 0;
        }
        .form-group label {
            display: block;
            font-weight: bold;
            margin-bottom: 8px;
            color: #374151;
        }
        .form-group input, .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 2px solid #E5E7EB;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.2s ease;
            box-sizing: border-box;
        }
        .form-group input:focus, .form-group textarea:focus {
            border-color: #00B4D8;
            outline: none;
            box-shadow: 0 0 0 3px rgba(0,180,216,0.1);
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .admin-login {
            max-width: 400px;
            margin: 50px auto;
            text-align: center;
        }
        .alert {
            padding: 16px;
            border-radius: 8px;
            margin: 15px 0;
            font-weight: 500;
        }
        .alert-success {
            background: linear-gradient(135deg, #D1FAE5, #A7F3D0);
            border-left: 4px solid #10B981;
            color: #065F46;
        }
        .alert-error {
            background: linear-gradient(135deg, #FEF2F2, #FECACA);
            border-left: 4px solid #EF4444;
            color: #991B1B;
        }
        .alert-info {
            background: linear-gradient(135deg, #DBEAFE, #BFDBFE);
            border-left: 4px solid #3B82F6;
            color: #1E40AF;
        }
        .small-text {
            font-size: 14px;
            color: #6B7280;
            margin-top: 5px;
        }
        .welcome-banner {
            background: linear-gradient(135deg, #00B4D8, #0077B6);
            color: white;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            border-bottom: 6px solid #F77F00;
            text-align: center;
        }
        .welcome-banner h2 {
            color: white;
            margin-bottom: 10px;
        }
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-top: 25px;
        }
        .nav-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 10px;
            padding: 15px 0;
        }
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            .form-row {
                grid-template-columns: 1fr;
            }
            .stats-grid {
                grid-template-columns: 1fr;
            }
            .nav-grid {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="nav">
        <h1>üèñÔ∏è Cape Coral Home Retreat</h1>
        <p>123 SW 51st Terrace, Cape Coral, Florida</p>
        <div id="guest-nav" class="nav-grid">
            <button class="btn active" onclick="showPage('home', this)">üè† Welcome</button>
            <button class="btn" onclick="showPage('access', this)">üîë Access Info</button>
            <button class="btn" onclick="showPage('attractions', this)">üìç Attractions</button>
            <button class="btn" onclick="showPage('photos', this)">üì∏ Photos</button>
            <button class="btn" onclick="showPage('music', this)">üéµ Music</button>
            <button class="btn" onclick="showPage('rules', this)">üìã Rules</button>
            <button class="btn" onclick="showPage('emergency', this)">üìû Emergency</button>
            <button class="btn" id="admin-btn" onclick="showPage('admin-login', this)" style="display: none;">‚öôÔ∏è Admin</button>
        </div>
        <div id="admin-nav" class="nav-grid" style="display: none;">
            <button class="btn" onclick="showPage('admin-dashboard', this)">üìä Dashboard</button>
            <button class="btn" onclick="showPage('admin-settings', this)">‚öôÔ∏è Settings</button>
            <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
        </div>
    </div>

    <div class="content">
        <!-- Home Page -->
        <div id="home-page">
            <div class="welcome-banner">
                <h2>Welcome to Cape Coral Home Retreat!</h2>
                <p>Your tropical paradise awaits in beautiful Cape Coral, Florida!</p>
            </div>
            
            <div class="stats-grid">
                <div class="card">
                    <h3>üìÖ Current Booking</h3>
                    <p><strong>Guest:</strong> <span id="display-guest-name">John & Sarah Smith</span></p>
                    <p><strong>Check-in:</strong> <span id="display-checkin">July 18, 2025</span></p>
                    <p><strong>Check-out:</strong> <span id="display-checkout">July 21, 2025</span></p>
                    <p><strong>Guests:</strong> <span id="display-guest-count">4</span></p>
                    <p><strong>Confirmation:</strong> <span id="display-confirmation">ABC123</span></p>
                </div>
                
                <div class="card" style="border-left-color: #F77F00;">
                    <h3>üîë Access Information</h3>
                    <p><strong>Door Code:</strong> <span id="display-door-code">1234</span></p>
                    <p><strong>WiFi:</strong> <span id="display-wifi-name">CapeCoral_Retreat_Guest</span></p>
                    <p><strong>Password:</strong> <span id="display-wifi-password">Tropical2025!</span></p>
                    <p class="small-text">Please keep this information secure</p>
                </div>
            </div>
        </div>

        <!-- Access Page -->
        <div id="access-page" style="display: none;">
            <h2>üîë Access Information</h2>
            <div class="stats-grid">
                <div class="card" style="background: linear-gradient(135deg, #DBEAFE, #BFDBFE); border-left-color: #2563EB;">
                    <h3>üö™ Door Access</h3>
                    <p style="font-size: 48px; font-weight: bold; color: #2563EB; margin: 15px 0; text-align: center;"><span id="access-door-code">1234</span></p>
                    <p style="text-align: center;">Enter this code on the front door keypad</p>
                </div>
                
                <div class="card" style="background: linear-gradient(135deg, #DCFCE7, #BBF7D0); border-left-color: #16A34A;">
                    <h3>üì∂ WiFi Network</h3>
                    <p style="font-weight: bold; color: #16A34A; font-size: 18px;"><span id="access-wifi-name">CapeCoral_Retreat_Guest</span></p>
                    <p style="font-weight: bold; color: #16A34A; font-size: 18px;"><span id="access-wifi-password">Tropical2025!</span></p>
                    <p class="small-text">Connect your devices to stay online</p>
                </div>
            </div>
        </div>

        <!-- Attractions Page -->
        <div id="attractions-page" style="display: none;">
            <h2>üìç Local Attractions</h2>
            <div class="stats-grid">
                <div class="attraction-card">
                    <h3>Yacht Club Beach</h3>
                    <p>Beach ‚Ä¢ 2.5 miles (6 min drive) ‚Ä¢ ‚≠ê 4.5</p>
                </div>
                <div class="attraction-card">
                    <h3>Cape Coral Beach at Four Freedoms Park</h3>
                    <p>Beach ‚Ä¢ 3.2 miles (8 min drive) ‚Ä¢ ‚≠ê 4.3</p>
                </div>
                <div class="attraction-card">
                    <h3>The Lobster Lady</h3>
                    <p>Restaurant ‚Ä¢ 4.8 miles (12 min drive) ‚Ä¢ ‚≠ê 5.0</p>
                </div>
                <div class="attraction-card">
                    <h3>Rotary Park Environmental Center</h3>
                    <p>Nature ‚Ä¢ 5.1 miles (12 min drive) ‚Ä¢ ‚≠ê 4.4</p>
                </div>
                <div class="attraction-card">
                    <h3>Sun Splash Family Waterpark</h3>
                    <p>Entertainment ‚Ä¢ 6.3 miles (15 min drive) ‚Ä¢ ‚≠ê 4.1</p>
                </div>
                <div class="attraction-card">
                    <h3>Cape Coral Farmers Market</h3>
                    <p>Shopping ‚Ä¢ 4.2 miles (10 min drive) ‚Ä¢ ‚≠ê 4.2</p>
                </div>
                <div class="attraction-card">
                    <h3>Edison and Ford Winter Estates</h3>
                    <p>Historical ‚Ä¢ 8.7 miles (20 min drive) ‚Ä¢ ‚≠ê 4.6</p>
                </div>
                <div class="attraction-card">
                    <h3>Seed to Table</h3>
                    <p>Restaurant ‚Ä¢ 15.2 miles to Naples (25 min drive) ‚Ä¢ ‚≠ê 5.0</p>
                </div>
            </div>
        </div>

        <!-- Photos Page -->
        <div id="photos-page" style="display: none;">
            <h2>üì∏ Property Photos</h2>
            
            <div class="welcome-banner" style="background: linear-gradient(135deg, #667eea, #764ba2); margin-bottom: 20px;">
                <h3 style="color: white; margin-bottom: 10px;">Cape Coral Home Retreat Gallery</h3>
                <p style="color: white; opacity: 0.9;">Take a virtual tour of your beautiful tropical retreat!</p>
            </div>
            
            <div id="photo-gallery" class="stats-grid">
                <!-- Photos will be loaded here -->
                <div class="card" style="text-align: center; padding: 40px;">
                    <h3 style="color: #6B7280;">üì∑ No Photos Yet</h3>
                    <p style="color: #9CA3AF;">Photos will appear here once uploaded in the admin panel.</p>
                </div>
            </div>
        </div>

        <!-- Music/Spotify Page -->
        <div id="music-page" style="display: none;">
            <h2>üéµ Home Audio System</h2>
            
            <div class="card" style="background: linear-gradient(135deg, #1DB954, #1ed760); color: white; border-left-color: #1DB954;">
                <h3 style="color: white;">üéß Connect to House Speakers</h3>
                <p style="color: white; opacity: 0.9;">Control the house music from your device!</p>
                
                <div style="margin: 20px 0;">
                    <button class="btn" onclick="connectSpotify()" style="background: #1DB954; border-bottom-color: #17a74a;">
                        üéµ Open Spotify
                    </button>
                    <button class="btn" onclick="showMusicInstructions()" style="background: #333; border-bottom-color: #1DB954;">
                        üì± How to Connect
                    </button>
                </div>
            </div>

            <div class="card">
                <h3>üé∂ Quick Setup Instructions</h3>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <h4>Method 1: Spotify Connect (Recommended)</h4>
                    <ol>
                        <li>Open <strong>Spotify</strong> on your phone or tablet</li>
                        <li>Play any song</li>
                        <li>Tap the <strong>"Devices"</strong> icon at the bottom</li>
                        <li>Select <strong>"Cape Coral Retreat Audio"</strong> from the list</li>
                        <li>Music will now play through the house speakers!</li>
                    </ol>
                </div>
                
                <div style="background: #e8f4fd; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <h4>Method 2: Direct Connection</h4>
                    <ol>
                        <li>Connect to the house WiFi: <strong><span id="music-wifi-name">CapeCoral_Retreat_Guest</span></strong></li>
                        <li>Open your music app (Spotify, Apple Music, etc.)</li>
                        <li>Look for <strong>"Cape Coral Home"</strong> in available speakers</li>
                        <li>Select it and enjoy your music throughout the house!</li>
                    </ol>
                </div>
            </div>

            <div class="card" style="border-left-color: #FF6B35;">
                <h3>üîä Audio Zones Available</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 15px 0;">
                    <div style="background: #f1f5f9; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>üè† Living Room</h4>
                        <p>Main entertainment area</p>
                        <button class="btn" onclick="selectZone('living')" style="font-size: 12px; padding: 6px 12px;">Select Zone</button>
                    </div>
                    <div style="background: #f1f5f9; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>üèä‚Äç‚ôÄÔ∏è Pool Area</h4>
                        <p>Outdoor speakers</p>
                        <button class="btn" onclick="selectZone('pool')" style="font-size: 12px; padding: 6px 12px;">Select Zone</button>
                    </div>
                    <div style="background: #f1f5f9; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>üç≥ Kitchen</h4>
                        <p>Cooking & dining</p>
                        <button class="btn" onclick="selectZone('kitchen')" style="font-size: 12px; padding: 6px 12px;">Select Zone</button>
                    </div>
                    <div style="background: #f1f5f9; padding: 15px; border-radius: 8px; text-align: center;">
                        <h4>üè° Whole House</h4>
                        <p>All speakers</p>
                        <button class="btn" onclick="selectZone('all')" style="font-size: 12px; padding: 6px 12px;">Select Zone</button>
                    </div>
                </div>
                <div id="zone-selected" style="display: none; background: #d1fae5; padding: 10px; border-radius: 6px; margin: 10px 0; color: #065f46;">
                    <strong>‚úÖ Zone Selected:</strong> <span id="selected-zone"></span>
                </div>
            </div>

            <div class="card">
                <h3>üéµ Suggested Playlists for Your Stay</h3>
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                    <div style="background: linear-gradient(135deg, #ff9a9e, #fecfef); padding: 15px; border-radius: 10px; cursor: pointer;" onclick="openPlaylist('tropical')">
                        <h4>üå¥ Tropical Vibes</h4>
                        <p style="font-size: 14px;">Perfect for poolside relaxation</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #a8edea, #fed6e3); padding: 15px; border-radius: 10px; cursor: pointer;" onclick="openPlaylist('chill')">
                        <h4>üòå Chill Lounge</h4>
                        <p style="font-size: 14px;">Relaxing background music</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #ffecd2, #fcb69f); padding: 15px; border-radius: 10px; cursor: pointer;" onclick="openPlaylist('party')">
                        <h4>üéâ Party Mix</h4>
                        <p style="font-size: 14px;">Upbeat songs for entertaining</p>
                    </div>
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); color: white; padding: 15px; border-radius: 10px; cursor: pointer;" onclick="openPlaylist('dinner')">
                        <h4 style="color: white;">üçΩÔ∏è Dinner Jazz</h4>
                        <p style="font-size: 14px; color: white;">Sophisticated dining ambiance</p>
                    </div>
                </div>
            </div>

            <div class="card" style="background: linear-gradient(135deg, #FFF3CD, #FFF8DC); border-left-color: #856404;">
                <h3>‚ö†Ô∏è Audio System Guidelines</h3>
                <ul style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>Volume:</strong> Please keep volume at reasonable levels, especially after 10 PM</li>
                    <li><strong>Pool Area:</strong> Outdoor speakers automatically turn off at 10 PM</li>
                    <li><strong>Troubleshooting:</strong> If music stops, check WiFi connection and restart the app</li>
                    <li><strong>Multiple Users:</strong> Only one device can control the system at a time</li>
                    <li><strong>Support:</strong> Contact property manager if you need assistance</li>
                </ul>
            </div>
        </div>

        <!-- Rules Page -->
        <div id="rules-page" style="display: none;">
            <h2>üìã House Rules & Guidelines</h2>
            
            <div class="welcome-banner" style="background: linear-gradient(135deg, #F77F00, #D97706); margin-bottom: 20px;">
                <h3 style="color: white; margin-bottom: 10px;">Welcome to Our Beautiful Home!</h3>
                <p style="color: white; opacity: 0.9;">Please review our guidelines to ensure you and future guests have a wonderful stay. Thank you for treating our home with care and respect!</p>
            </div>

            <div class="card">
                <h3>üè† House Rules</h3>
                <div style="display: grid; gap: 15px;">
                    <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444;">
                        <strong>1. No Pets</strong> ‚Äì To maintain an allergy-free environment, pets are not allowed.
                    </div>
                    <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444;">
                        <strong>2. No Smoking or Vaping</strong> ‚Äì Smoking of any kind is strictly prohibited inside and outside the property.
                    </div>
                    <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444;">
                        <strong>3. No Drugs or Illegal Substances</strong> ‚Äì We have a zero-tolerance policy for any illegal activity.
                    </div>
                    <div style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444;">
                        <strong>4. No Parties or Events</strong> ‚Äì The home is for registered guests only. Please respect our peaceful neighborhood.
                    </div>
                    <div style="background: #fff7ed; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <strong>5. Quiet Hours</strong> ‚Äì From 10 PM to 8 AM, please keep noise to a minimum to ensure a restful environment for everyone.
                    </div>
                    <div style="background: #fff7ed; padding: 15px; border-radius: 8px; border-left: 4px solid #f59e0b;">
                        <strong>6. No Loud Music</strong> ‚Äì Enjoy music at a reasonable volume both indoors and outdoors.
                    </div>
                    <div style="background: #f0f9ff; padding: 15px; border-radius: 8px; border-left: 4px solid #3b82f6;">
                        <strong>7. Parking</strong> ‚Äì Park only in the designated driveway spots. No parking on the street or grass to avoid fines and property damage.
                    </div>
                </div>
            </div>

            <div class="card" style="border-left-color: #0ea5e9;">
                <h3>üö§ Boat and Dock Policy</h3>
                <p style="background: #fef2f2; padding: 15px; border-radius: 8px; border-left: 4px solid #ef4444; margin: 10px 0;">
                    <strong>The boat and boat lift are off-limits.</strong> Please do not attempt to use or operate them.
                </p>
            </div>

            <div class="card" style="border-left-color: #8b5cf6;">
                <h3>üß∫ Laundry Use</h3>
                <p>The washer and dryer are available for your use. <strong>Please do not leave wet laundry in the washer to prevent mildew.</strong></p>
            </div>

            <div class="card" style="border-left-color: #22c55e;">
                <h3>üóëÔ∏è Garbage & Recycling</h3>
                <div style="background: #f0fdf4; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <p><strong>Pickup Schedule:</strong> Garbage and recycling bins must be placed curbside Sunday night for Monday morning pickup.</p>
                    <ul style="margin: 10px 0; padding-left: 20px;">
                        <li><strong>Bin Placement:</strong> Ensure the wheels on both bins face the house when placed at the curb</li>
                        <li><strong>Indoor Garbage:</strong> The kitchen garbage can is located under the counter to the left of the dishwasher</li>
                        <li><strong>Daily Disposal:</strong> Please empty household trash daily into the outdoor bins</li>
                        <li><strong>Outdoor Bin Location:</strong> The garbage and recycling bins are located to the right of the garage, next to the AC unit</li>
                    </ul>
                    <p><em>Thank you for helping us keep the home clean!</em></p>
                </div>
            </div>

            <div class="card" style="border-left-color: #f59e0b;">
                <h3>ü™ü Shades and Storm Screens</h3>
                <p><strong>Living Room Shades:</strong> Please keep these up to enjoy the natural light.</p>
                <p><strong>Storm Shutter Sunscreen:</strong> You may lower it for privacy, but make sure the screen path is clear of furniture or any obstructions before operating it. The remote for the Storm Shutter is to the right of the double slider door, before going to main master bedroom.</p>
            </div>

            <div class="card" style="border-left-color: #ec4899;">
                <h3>üõ†Ô∏è Respect the Property</h3>
                <p>Treat the home with care, as you would your own. <strong>Report any damage immediately</strong> so we can address it promptly.</p>
            </div>

            <div class="card" style="border-left-color: #06b6d4;">
                <h3>‚úÖ Check-Out Instructions</h3>
                <ol style="margin: 10px 0; padding-left: 20px;">
                    <li><strong>Lights:</strong> Ensure all lights are turned off</li>
                    <li><strong>Sliders:</strong> Verify that all sliding doors are closed and locked</li>
                    <li><strong>Laundry:</strong> Do not leave wet clothes or towels in the washer</li>
                    <li><strong>Used Sheets:</strong> Simply leave the bed unmade, and our cleaning team will launder them after your checkout</li>
                    <li><strong>Securing the Door:</strong> Push the front door closed firmly, then press the lock icon on the keypad to secure the door</li>
                </ol>
            </div>
        </div>

        <!-- Emergency Page -->
        <div id="emergency-page" style="display: none;">
            <h2>üìû Emergency Contacts</h2>
            <div class="stats-grid">
                <div class="emergency-card">
                    <h3>Local Property Manager</h3>
                    <p style="font-size: 28px; font-weight: bold; margin: 15px 0;">
                        <a href="tel:+12397229391" class="phone-link">(239) 722-9391</a>
                    </p>
                    <p class="small-text">Juan - Local Property Manager</p>
                </div>
                <div class="emergency-card">
                    <h3>Emergency Services</h3>
                    <p style="font-size: 28px; font-weight: bold; margin: 15px 0;">
                        <a href="tel:911" class="phone-link">911</a>
                    </p>
                    <p class="small-text">Police / Fire / Medical Emergency</p>
                </div>
                <div class="emergency-card">
                    <h3>Cape Coral Police</h3>
                    <p style="font-size: 28px; font-weight: bold; margin: 15px 0;">
                        <a href="tel:+12395743223" class="phone-link">(239) 574-3223</a>
                    </p>
                    <p class="small-text">Non-Emergency Police</p>
                </div>
                <div class="emergency-card">
                    <h3>Cape Coral Fire Dept</h3>
                    <p style="font-size: 28px; font-weight: bold; margin: 15px 0;">
                        <a href="tel:+12395740501" class="phone-link">(239) 574-0501</a>
                    </p>
                </div>
                <div class="emergency-card">
                    <h3>Lee County Emergency</h3>
                    <p style="font-size: 28px; font-weight: bold; margin: 15px 0;">
                        <a href="tel:+12395330622" class="phone-link">(239) 533-0622</a>
                    </p>
                    <p class="small-text">Emergency Management</p>
                </div>
            </div>
        </div>

        <!-- Admin Login -->
        <div id="admin-login-page" style="display: none;">
            <div class="admin-login">
                <div class="admin-card card">
                    <h2>üîê Admin Access</h2>
                    <p>Enter admin password to manage property settings</p>
                    <div class="form-group">
                        <input type="password" id="admin-password" placeholder="Enter admin password" onkeypress="if(event.key==='Enter') login()">
                    </div>
                    <button class="btn btn-success" onclick="login()">Login</button>
                </div>
            </div>
        </div>

        <!-- Admin Dashboard -->
        <div id="admin-dashboard-page" style="display: none;">
            <h2>üìä Admin Dashboard</h2>
            
            <!-- Airbnb CSV Import -->
            <div class="admin-card card">
                <h3>üì§ Import from Airbnb</h3>
                <div class="alert-info" style="margin-bottom: 20px;">
                    <strong>How to get Airbnb data:</strong> Go to Host Dashboard ‚Üí Progress ‚Üí Insights ‚Üí Export Data ‚Üí Select "Reservations" ‚Üí Download CSV
                </div>
                
                <div class="form-group">
                    <label>Upload Airbnb CSV File</label>
                    <input type="file" id="airbnb-csv" accept=".csv" onchange="processAirbnbCSV()">
                    <p class="small-text">Upload your Airbnb reservations CSV to automatically import booking data</p>
                </div>
                
                <div id="csv-preview" style="display: none; margin: 20px 0;">
                    <h4>üìã Imported Bookings Preview:</h4>
                    <div id="csv-data" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
                
                <button class="btn" onclick="parseAirbnbData()" style="display: none;" id="parse-btn">üìä Process CSV Data</button>
            </div>
            
            <div class="admin-card card">
                <h3>Current Booking Management</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Guest Name</label>
                        <input type="text" id="admin-guest-name" value="John & Sarah Smith">
                    </div>
                    <div class="form-group">
                        <label>Guest Count</label>
                        <input type="number" id="admin-guest-count" value="4" min="1" max="6">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Check-in Date</label>
                        <input type="date" id="admin-checkin" value="2025-07-18">
                    </div>
                    <div class="form-group">
                        <label>Check-out Date</label>
                        <input type="date" id="admin-checkout" value="2025-07-21">
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>Confirmation Code</label>
                        <input type="text" id="admin-confirmation" value="ABC123">
                    </div>
                    <div class="form-group">
                        <label>Door Code</label>
                        <input type="text" id="admin-door-code" value="1234">
                    </div>
                </div>
                <button class="btn btn-success" onclick="updateGuestInfo()">Update Guest Information</button>
                <button class="btn" onclick="generateNewDoorCode()">üîë Generate New Door Code</button>
            </div>
        </div>

        <!-- Admin Settings -->
        <div id="admin-settings-page" style="display: none;">
            <h2>‚öôÔ∏è Admin Settings</h2>
            
            <div class="admin-card card">
                <h3>WiFi Settings</h3>
                <div class="form-row">
                    <div class="form-group">
                        <label>Network Name</label>
                        <input type="text" id="admin-wifi-name" value="CapeCoral_Retreat_Guest">
                    </div>
                    <div class="form-group">
                        <label>WiFi Password</label>
                        <input type="text" id="admin-wifi-password" value="Tropical2025!">
                    </div>
                </div>
                <button class="btn btn-success" onclick="updateWifiSettings()">Update WiFi Settings</button>
            </div>

            <div class="admin-card card">
                <h3>üßπ Cleaning Company Management</h3>
                
                <div class="form-group">
                    <label>Cleaning Company Contact</label>
                    <div class="form-row">
                        <div class="form-group">
                            <input type="text" id="cleaning-company" placeholder="Company Name" value="Cape Coral Cleaning Services">
                        </div>
                        <div class="form-group">
                            <input type="tel" id="cleaning-phone" placeholder="Phone Number" value="(239) 555-0199">
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label>Schedule Cleaning After Check-out</label>
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap;">
                        <input type="date" id="cleaning-date" style="flex: 1; min-width: 150px;">
                        <input type="time" id="cleaning-time" value="11:30" style="flex: 1; min-width: 120px;">
                        <button class="btn" onclick="scheduleCleaningFromCheckout()">Auto-Schedule</button>
                    </div>
                    <p class="small-text">Auto-schedule will set cleaning 30 minutes after check-out time</p>
                </div>

                <div class="form-group">
                    <label>Cleaning Checklist</label>
                    <textarea id="cleaning-checklist" rows="8" style="width: 100%;">LIVING AREAS: ‚úì Vacuum all carpets and rugs ‚úì Mop all hard floors ‚úì Dust all surfaces
KITCHEN: ‚úì Clean countertops ‚úì Clean appliances ‚úì Restock supplies
BATHROOMS: ‚úì Clean and disinfect ‚úì Replace towels ‚úì Restock supplies
BEDROOMS: ‚úì Fresh linens ‚úì Vacuum floors ‚úì Dust surfaces
FINAL: ‚úì Set thermostat to 72¬∞F ‚úì Test WiFi ‚úì Check door code</textarea>
                </div>

                <div class="form-row">
                    <button class="btn btn-success" onclick="saveCleaningInfo()">Save Cleaning Details</button>
                    <button class="btn" onclick="sendCleaningReminder()">üì± Send SMS Reminder</button>
                </div>
            </div>

            <div class="admin-card card">
                <h3>üóëÔ∏è Trash Pickup Management</h3>
                
                <div class="alert-info" style="margin-bottom: 20px;">
                    <strong>Pickup Schedule:</strong> Monday morning pickup - trash goes out Sunday night
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <h4>üìç Trash Bin Location</h4>
                    <p><strong>Location:</strong> Right side of house next to AC units</p>
                    <p><strong>Instructions for Guests:</strong></p>
                    <ul>
                        <li>Take bins to the curb Sunday evening</li>
                        <li>Return empty bins to AC unit area after pickup</li>
                        <li>Both regular trash and recycling bins available</li>
                    </ul>
                </div>

                <div class="form-group">
                    <label>Current Week Reminder Status</label>
                    <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
                        <button class="btn" onclick="sendTrashReminder()">üì± Send Trash Reminder to Guest</button>
                        <button class="btn" onclick="markTrashCompleted()">‚úÖ Mark as Completed</button>
                        <span id="trash-status" style="padding: 8px 15px; border-radius: 5px; background: #fef3c7; color: #92400e;">Pending</span>
                    </div>
                </div>

                <div class="form-group">
                    <label>Custom Trash Instructions</label>
                    <textarea id="trash-instructions" rows="4" style="width: 100%;">Please take trash bins to the curb Sunday evening for Monday morning pickup. Bins are located on the right side of the house next to the AC units. Return empty bins to the same location after pickup. Thank you!</textarea>
                </div>

                <button class="btn btn-success" onclick="saveTrashInfo()">Save Trash Instructions</button>
            </div>

            <div class="admin-card card">
                <h3>Property Information</h3>
                <div class="form-group">
                    <label>Property Name</label>
                    <input type="text" id="admin-property-name" value="Cape Coral Home Retreat">
                </div>
                <div class="form-group">
                    <label>Property Address</label>
                    <input type="text" id="admin-property-address" value="123 SW 51st Terrace, Cape Coral, Florida">
                </div>
                
                <div class="form-group">
                    <label>Property Photo</label>
                    <input type="file" id="property-photo" accept="image/*" onchange="uploadPropertyPhoto()">
                    <p class="small-text">Upload a photo of your property to display on the welcome page</p>
                    <div id="photo-preview" style="margin-top: 15px;">
                        <!-- Photo preview will appear here -->
                    </div>
                </div>
                
                <button class="btn btn-success" onclick="updatePropertyInfo()">Update Property Info</button>
            </div>
        </div>
    </div>

    <script>
        // Guest data
        let guestData = {
            guestName: 'John & Sarah Smith',
            checkIn: 'July 18, 2025',
            checkOut: 'July 21, 2025',
            guestCount: 4,
            confirmation: 'ABC123',
            doorCode: '1234',
            wifiName: 'CapeRetreatGuest',
            wifiPassword: 'HavingFun2025'
        };

        function showPage(pageId, buttonElement) {
            // Hide all pages
            const pages = ['home', 'access', 'attractions', 'photos', 'music', 'rules', 'emergency', 'admin-login', 'admin-dashboard', 'admin-settings'];
            pages.forEach(page => {
                const element = document.getElementById(page + '-page');
                if (element) element.style.display = 'none';
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.style.display = 'block';
            }
            
            // Update button states
            const buttons = document.querySelectorAll('.btn');
            buttons.forEach(btn => btn.classList.remove('active'));
            if (buttonElement) {
                buttonElement.classList.add('active');
            }
        }

        function login() {
            const password = document.getElementById('admin-password').value;
            if (password === 'admin1128') {
                document.getElementById('guest-nav').style.display = 'none';
                document.getElementById('admin-nav').style.display = 'flex';
                showPage('admin-dashboard');
                loadAdminData();
                document.getElementById('admin-password').value = '';
                showAlert('Admin access granted', 'success');
            } else {
                showAlert('Invalid password', 'error');
            }
        }

        function logout() {
            document.getElementById('guest-nav').style.display = 'flex';
            document.getElementById('admin-nav').style.display = 'none';
            showPage('home');
            showAlert('Logged out successfully', 'info');
        }

        function loadAdminData() {
            // Load current guest data into admin form
            document.getElementById('admin-guest-name').value = guestData.guestName;
            document.getElementById('admin-guest-count').value = guestData.guestCount;
            document.getElementById('admin-confirmation').value = guestData.confirmation;
            document.getElementById('admin-door-code').value = guestData.doorCode;
            document.getElementById('admin-wifi-name').value = guestData.wifiName;
            document.getElementById('admin-wifi-password').value = guestData.wifiPassword;
            
            // Convert formatted dates back to input format for admin form
            const checkinInput = document.getElementById('admin-checkin');
            const checkoutInput = document.getElementById('admin-checkout');
            
            // Only set default dates if we don't have saved dates
            if (checkinInput && !guestData.rawCheckIn) {
                checkinInput.value = '2025-07-18';
            } else if (checkinInput && guestData.rawCheckIn) {
                checkinInput.value = guestData.rawCheckIn;
            }
            
            if (checkoutInput && !guestData.rawCheckOut) {
                checkoutInput.value = '2025-07-21';
            } else if (checkoutInput && guestData.rawCheckOut) {
                checkoutInput.value = guestData.rawCheckOut;
            }
            
            // Load cleaning data
            loadCleaningData();
            
            // Load property photo
            loadPropertyPhoto();
        }

        function updateGuestInfo() {
            // Get values from admin form
            const newGuestName = document.getElementById('admin-guest-name').value;
            const newGuestCount = parseInt(document.getElementById('admin-guest-count').value);
            const newConfirmation = document.getElementById('admin-confirmation').value;
            const newDoorCode = document.getElementById('admin-door-code').value;
            const checkinDate = document.getElementById('admin-checkin').value;
            const checkoutDate = document.getElementById('admin-checkout').value;
            
            // Update guestData object
            guestData.guestName = newGuestName;
            guestData.guestCount = newGuestCount; // Make sure it's a number
            guestData.confirmation = newConfirmation;
            guestData.doorCode = newDoorCode;
            
            // Store raw dates for admin form
            guestData.rawCheckIn = checkinDate;
            guestData.rawCheckOut = checkoutDate;
            
            // Format and update display dates
            if (checkinDate) {
                guestData.checkIn = new Date(checkinDate).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            }
            if (checkoutDate) {
                guestData.checkOut = new Date(checkoutDate).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            }
            
            // Save to localStorage for persistence
            try {
                localStorage.setItem('capeCoralGuestData', JSON.stringify(guestData));
                console.log('Saved guest data:', guestData); // Debug log
            } catch (error) {
                console.log('Could not save guest data');
            }
            
            // Update all displays
            updateDisplays();
            
            showAlert(`Guest information updated for ${newGuestName} (${newGuestCount} guests)!`, 'success');
        }

        function updateWifiSettings() {
            guestData.wifiName = document.getElementById('admin-wifi-name').value;
            guestData.wifiPassword = document.getElementById('admin-wifi-password').value;
            
            updateDisplays();
            showAlert('WiFi settings updated successfully!', 'success');
        }

        function updatePropertyInfo() {
            const propertyName = document.getElementById('admin-property-name').value;
            const propertyAddress = document.getElementById('admin-property-address').value;
            
            document.querySelector('.nav h1').textContent = 'üèñÔ∏è ' + propertyName;
            document.querySelector('.nav p').textContent = propertyAddress;
            
            showAlert('Property information updated successfully!', 'success');
        }

        function updateDisplays() {
            // Update all guest display elements on Welcome page
            const displayGuestName = document.getElementById('display-guest-name');
            const displayCheckin = document.getElementById('display-checkin');
            const displayCheckout = document.getElementById('display-checkout');
            const displayGuestCount = document.getElementById('display-guest-count');
            const displayConfirmation = document.getElementById('display-confirmation');
            const displayDoorCode = document.getElementById('display-door-code');
            const displayWifiName = document.getElementById('display-wifi-name');
            const displayWifiPassword = document.getElementById('display-wifi-password');
            
            // Update Access page elements
            const accessDoorCode = document.getElementById('access-door-code');
            const accessWifiName = document.getElementById('access-wifi-name');
            const accessWifiPassword = document.getElementById('access-wifi-password');
            
            // Update Music page WiFi name
            const musicWifiName = document.getElementById('music-wifi-name');
            
            // Update Welcome page
            if (displayGuestName) displayGuestName.textContent = guestData.guestName;
            if (displayCheckin) displayCheckin.textContent = guestData.checkIn;
            if (displayCheckout) displayCheckout.textContent = guestData.checkOut;
            if (displayGuestCount) displayGuestCount.textContent = guestData.guestCount;
            if (displayConfirmation) displayConfirmation.textContent = guestData.confirmation;
            if (displayDoorCode) displayDoorCode.textContent = guestData.doorCode;
            if (displayWifiName) displayWifiName.textContent = guestData.wifiName;
            if (displayWifiPassword) displayWifiPassword.textContent = guestData.wifiPassword;
            
            // Update Access page
            if (accessDoorCode) accessDoorCode.textContent = guestData.doorCode;
            if (accessWifiName) accessWifiName.textContent = guestData.wifiName;
            if (accessWifiPassword) accessWifiPassword.textContent = guestData.wifiPassword;
            
            // Update Music page
            if (musicWifiName) musicWifiName.textContent = guestData.wifiName;
            
            console.log('Display updated with:', guestData); // Debug log
        }

        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            alertDiv.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                z-index: 1000;
                max-width: 300px;
                animation: slideIn 0.3s ease;
            `;
            
            document.body.appendChild(alertDiv);
            setTimeout(() => {
                if (alertDiv.parentNode) {
                    alertDiv.remove();
                }
            }, 4000);
        }

        // Music/Audio System Functions
        function connectSpotify() {
            // Check if we're on mobile/tablet
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // Try to open Spotify app directly
                const spotifyAppURL = 'spotify://';
                const spotifyWebURL = 'https://open.spotify.com';
                
                // Create a hidden iframe to attempt app launch
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = spotifyAppURL;
                document.body.appendChild(iframe);
                
                // Fallback to web version after a short delay
                setTimeout(() => {
                    document.body.removeChild(iframe);
                    window.open(spotifyWebURL, '_blank');
                }, 1000);
                
                showAlert('Opening Spotify... Look for "Cape Coral Retreat Audio" in your devices list!', 'success');
            } else {
                // Desktop - open Spotify Web Player
                window.open('https://open.spotify.com', '_blank');
                showAlert('Spotify opened! Look for "Cape Coral Retreat Audio" in the devices list.', 'info');
            }
        }

        function showMusicInstructions() {
            showAlert('üì± Connect to house WiFi, then look for "Cape Coral Retreat Audio" in your music app!', 'info');
        }

        function selectZone(zone) {
            const zones = {
                'living': 'Living Room',
                'pool': 'Pool Area',
                'kitchen': 'Kitchen',
                'all': 'Whole House'
            };
            
            document.getElementById('selected-zone').textContent = zones[zone];
            document.getElementById('zone-selected').style.display = 'block';
            
            showAlert(`Audio zone set to: ${zones[zone]}`, 'success');
            
            // Hide the notification after showing the selected zone
            setTimeout(() => {
                const zoneEl = document.getElementById('zone-selected');
                if (zoneEl) zoneEl.style.display = 'none';
            }, 5000);
        }

        function openPlaylist(type) {
            const playlists = {
                'tropical': 'https://open.spotify.com/playlist/37i9dQZF1DX0XUsuxWHRQd',
                'chill': 'https://open.spotify.com/playlist/37i9dQZF1DWS1zOdTE8uo8',
                'party': 'https://open.spotify.com/playlist/37i9dQZF1DX0XUfTFmNBRM',
                'dinner': 'https://open.spotify.com/playlist/37i9dQZF1DX0SM0LYsmbMT'
            };
            
            const playlistNames = {
                'tropical': 'Tropical Vibes',
                'chill': 'Chill Lounge',
                'party': 'Party Mix',
                'dinner': 'Dinner Jazz'
            };
            
            // Try to open Spotify app first on mobile
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // Convert web URL to app URL
                const appURL = playlists[type].replace('https://open.spotify.com', 'spotify:');
                
                // Try app first, fallback to web
                const iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.src = appURL;
                document.body.appendChild(iframe);
                
                setTimeout(() => {
                    document.body.removeChild(iframe);
                    window.open(playlists[type], '_blank');
                }, 1000);
            } else {
                window.open(playlists[type], '_blank');
            }
            
            showAlert(`Opening ${playlistNames[type]} playlist! Remember to select "Cape Coral Retreat Audio" as your device.`, 'success');
        }

        // Cleaning Management Functions
        function scheduleCleaningFromCheckout() {
            const checkOutDate = document.getElementById('admin-checkout').value;
            if (checkOutDate) {
                document.getElementById('cleaning-date').value = checkOutDate;
                document.getElementById('cleaning-time').value = '11:30';
                showAlert('Cleaning automatically scheduled for 30 minutes after checkout!', 'success');
            } else {
                showAlert('Please set a check-out date first in the Dashboard', 'error');
            }
        }

        function saveCleaningInfo() {
            const company = document.getElementById('cleaning-company').value;
            const phone = document.getElementById('cleaning-phone').value;
            const date = document.getElementById('cleaning-date').value;
            const time = document.getElementById('cleaning-time').value;
            const checklist = document.getElementById('cleaning-checklist').value;
            
            // Save to localStorage
            const cleaningData = {
                company,
                phone,
                date,
                time,
                checklist,
                lastUpdated: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('capeCoralCleaning', JSON.stringify(cleaningData));
                showAlert('Cleaning information saved successfully!', 'success');
            } catch (error) {
                showAlert('Could not save cleaning data', 'error');
            }
        }

        function sendCleaningReminder() {
            const company = document.getElementById('cleaning-company').value;
            const phone = document.getElementById('cleaning-phone').value;
            const date = document.getElementById('cleaning-date').value;
            const time = document.getElementById('cleaning-time').value;
            
            if (!company || !phone || !date || !time) {
                showAlert('Please fill in cleaning company, phone number, date, and time first', 'error');
                return;
            }
            
            // Format the date nicely
            const formattedDate = new Date(date).toLocaleDateString('en-US', { 
                weekday: 'long', 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
            
            // Create detailed message
            const message = `Hi ${company}! 

Cleaning reminder for Cape Coral Home Retreat:
üìÖ Date: ${formattedDate}
‚è∞ Time: ${time}
üè† Address: 123 SW 51st Terrace, Cape Coral, FL

Please confirm you can make this appointment. Thanks!`;
            
            // Clean phone number (remove non-digits)
            const cleanPhone = phone.replace(/\D/g, '');
            
            // Create SMS link
            const smsLink = `sms:+1${cleanPhone}?body=${encodeURIComponent(message)}`;
            
            // Check if we're on mobile/tablet
            const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
            
            if (isMobile) {
                // On mobile - open SMS app directly
                window.location.href = smsLink;
                showAlert('Opening SMS app to send reminder...', 'success');
            } else {
                // On desktop - show instructions window
                const instructionWindow = window.open('', 'SMS Instructions', 'width=500,height=400');
                instructionWindow.document.write(`
                    <!DOCTYPE html>
                    <html>
                    <head>
                        <title>Send SMS Reminder</title>
                        <style>
                            body { font-family: Arial, sans-serif; padding: 20px; background: #f8fafc; }
                            .container { background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
                            .message-box { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0; white-space: pre-line; border-left: 4px solid #00B4D8; }
                            .phone { font-size: 18px; font-weight: bold; color: #00B4D8; }
                            .copy-btn { background: #00B4D8; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 10px 5px; }
                            .copy-btn:hover { background: #0096C7; }
                        </style>
                    </head>
                    <body>
                        <div class="container">
                            <h2>üì± Send SMS Reminder</h2>
                            <p><strong>Send to:</strong> <span class="phone">${phone}</span></p>
                            
                            <h3>Message:</h3>
                            <div class="message-box">${message}</div>
                            
                            <button class="copy-btn" onclick="navigator.clipboard.writeText('${message}'); alert('Message copied!')">üìã Copy Message</button>
                            <button class="copy-btn" onclick="navigator.clipboard.writeText('${cleanPhone}'); alert('Phone number copied!')">üìû Copy Phone</button>
                            <button class="copy-btn" onclick="window.close()">‚ùå Close</button>
                            
                            <h3>Instructions:</h3>
                            <ol>
                                <li>Copy the message and phone number using the buttons above</li>
                                <li>Open your phone's messaging app</li>
                                <li>Create a new message to the copied phone number</li>
                                <li>Paste the copied message and send!</li>
                            </ol>
                        </div>
                    </body>
                    </html>
                `);
                showAlert('SMS reminder window opened with message details', 'info');
            }
        }

        function loadCleaningData() {
            try {
                const saved = localStorage.getItem('capeCoralCleaning');
                if (saved) {
                    const cleaningData = JSON.parse(saved);
                    document.getElementById('cleaning-company').value = cleaningData.company || 'Cape Coral Cleaning Services';
                    document.getElementById('cleaning-phone').value = cleaningData.phone || '(239) 555-0199';
                    document.getElementById('cleaning-date').value = cleaningData.date || '';
                    document.getElementById('cleaning-time').value = cleaningData.time || '11:30';
                    document.getElementById('cleaning-checklist').value = cleaningData.checklist || document.getElementById('cleaning-checklist').value;
                }
                
                // Load trash data
                const savedTrash = localStorage.getItem('capeCoralTrash');
                if (savedTrash) {
                    const trashData = JSON.parse(savedTrash);
                    document.getElementById('trash-instructions').value = trashData.instructions || document.getElementById('trash-instructions').value;
                    updateTrashStatus(trashData.status || 'pending');
                }
            } catch (error) {
                console.log('No saved cleaning/trash data found');
            }
        }

        // Trash Management Functions
        function sendTrashReminder() {
            const guestName = guestData.guestName;
            const instructions = document.getElementById('trash-instructions').value;
            
            // Create reminder message
            const message = `Hi ${guestName}!

Friendly reminder about trash pickup at Cape Coral Home Retreat:

üóëÔ∏è TRASH PICKUP: Monday morning
üìÖ ACTION NEEDED: Please take bins to curb Sunday evening

üìç Bin Location: Right side of house next to AC units

${instructions}

Thank you for helping keep our property clean!`;
            
            // For now, show the message (in real app, this could send SMS/email)
            const reminderWindow = window.open('', 'TrashReminder', 'width=500,height=400');
            reminderWindow.document.write(`
                <!DOCTYPE html>
                <html>
                <head>
                    <title>Trash Pickup Reminder</title>
                    <style>
                        body { font-family: Arial, sans-serif; padding: 20px; background: #f8fafc; }
                        .container { background: white; padding: 25px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
                        .message-box { background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0; white-space: pre-line; border-left: 4px solid #F77F00; }
                        .copy-btn { background: #F77F00; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin: 10px 5px; }
                        .copy-btn:hover { background: #D97706; }
                    </style>
                </head>
                <body>
                    <div class="container">
                        <h2>üóëÔ∏è Trash Pickup Reminder</h2>
                        <p><strong>For:</strong> ${guestName}</p>
                        
                        <h3>Message:</h3>
                        <div class="message-box">${message}</div>
                        
                        <button class="copy-btn" onclick="navigator.clipboard.writeText('${message}'); alert('Message copied!')">üìã Copy Message</button>
                        <button class="copy-btn" onclick="window.close()">‚ùå Close</button>
                        
                        <p><strong>Note:</strong> Copy this message to send via your preferred method (SMS, email, etc.)</p>
                    </div>
                </body>
                </html>
            `);
            
            showAlert('Trash reminder prepared for guest', 'success');
        }

        function markTrashCompleted() {
            updateTrashStatus('completed');
            saveTrashInfo();
            showAlert('Trash pickup marked as completed', 'success');
        }

        function updateTrashStatus(status) {
            const statusEl = document.getElementById('trash-status');
            if (statusEl) {
                if (status === 'completed') {
                    statusEl.textContent = 'Completed';
                    statusEl.style.background = '#d1fae5';
                    statusEl.style.color = '#065f46';
                } else {
                    statusEl.textContent = 'Pending';
                    statusEl.style.background = '#fef3c7';
                    statusEl.style.color = '#92400e';
                }
            }
        }

        function saveTrashInfo() {
            const instructions = document.getElementById('trash-instructions').value;
            const statusEl = document.getElementById('trash-status');
            const status = statusEl ? statusEl.textContent.toLowerCase() : 'pending';
            
            const trashData = {
                instructions,
                status,
                lastUpdated: new Date().toISOString()
            };
            
            try {
                localStorage.setItem('capeCoralTrash', JSON.stringify(trashData));
                showAlert('Trash information saved successfully!', 'success');
            } catch (error) {
                showAlert('Could not save trash data', 'error');
            }
        }

        // Airbnb CSV Import Functions
        function processAirbnbCSV() {
            const fileInput = document.getElementById('airbnb-csv');
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const csv = e.target.result;
                    displayCSVPreview(csv);
                    document.getElementById('parse-btn').style.display = 'inline-block';
                };
                
                reader.readAsText(file);
            }
        }

        function displayCSVPreview(csv) {
            const lines = csv.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            
            // Show first few lines as preview
            let previewHTML = '<div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin: 15px 0;">';
            previewHTML += '<strong>CSV Headers Found:</strong><br>';
            previewHTML += headers.join(', ');
            previewHTML += '</div>';
            
            previewHTML += '<div style="background: #e8f4fd; padding: 15px; border-radius: 8px; margin: 15px 0;">';
            previewHTML += '<strong>Preview:</strong><br>';
            previewHTML += `Found ${lines.length - 1} booking records`;
            previewHTML += '</div>';
            
            document.getElementById('csv-data').innerHTML = previewHTML;
            document.getElementById('csv-preview').style.display = 'block';
            
            // Store CSV data for processing
            window.csvData = csv;
        }

        function parseAirbnbData() {
            if (!window.csvData) {
                showAlert('No CSV data to process', 'error');
                return;
            }
            
            const lines = window.csvData.split('\n');
            const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
            const bookings = [];
            
            // Parse CSV data
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = lines[i].split(',').map(v => v.trim().replace(/"/g, ''));
                    const booking = {};
                    
                    headers.forEach((header, index) => {
                        booking[header] = values[index] || '';
                    });
                    
                    if (booking['Guest name'] || booking['Guest Name']) {
                        bookings.push(booking);
                    }
                }
            }
            
            if (bookings.length === 0) {
                showAlert('No valid bookings found in CSV', 'error');
                return;
            }
            
            displayBookingsList(bookings);
        }

        function displayBookingsList(bookings) {
            let html = '<h4>üìã Select a Booking to Import:</h4>';
            html += '<div style="max-height: 400px; overflow-y: auto;">';
            
            bookings.forEach((booking, index) => {
                // Try different possible column names from Airbnb CSV
                const guestName = booking['Guest name'] || booking['Guest Name'] || booking['Guest'] || 'Unknown Guest';
                const checkIn = booking['Start date'] || booking['Check-in'] || booking['Checkin'] || booking['Check in'] || '';
                const checkOut = booking['End date'] || booking['Check-out'] || booking['Checkout'] || booking['Check out'] || '';
                const confirmation = booking['Confirmation code'] || booking['Confirmation Code'] || booking['Confirmation'] || `BK${Date.now()}${index}`;
                const nights = booking['Nights'] || booking['# of nights'] || 'N/A';
                
                // Better guest count calculation for display
                let guestCount = 0;
                const adults = parseInt(booking['# of adults'] || booking['Adults'] || 0);
                const children = parseInt(booking['# of children'] || booking['Children'] || 0);
                const infants = parseInt(booking['# of infants'] || booking['Infants'] || 0);
                const totalGuests = parseInt(booking['Guests'] || booking['Guest count'] || booking['# of guests'] || 0);
                
                if (totalGuests > 0) {
                    guestCount = totalGuests;
                } else if (adults > 0 || children > 0 || infants > 0) {
                    guestCount = adults + children + infants;
                } else {
                    guestCount = 2; // Default
                }
                
                // Show breakdown if available
                let guestDisplay = `${guestCount} total`;
                if (adults > 0 || children > 0 || infants > 0) {
                    const breakdown = [];
                    if (adults > 0) breakdown.push(`${adults} adults`);
                    if (children > 0) breakdown.push(`${children} children`);
                    if (infants > 0) breakdown.push(`${infants} infants`);
                    guestDisplay = `${guestCount} total (${breakdown.join(', ')})`;
                }
                
                html += `
                    <div style="background: #f8f9fa; border: 1px solid #e5e7eb; border-radius: 8px; padding: 15px; margin: 10px 0; cursor: pointer; transition: all 0.2s ease;" 
                         onclick="importBooking(${index})" onmouseover="this.style.background='#e8f4fd'" onmouseout="this.style.background='#f8f9fa'">
                        <div style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 15px; align-items: center;">
                            <div>
                                <strong style="color: #1f2937;">${guestName}</strong><br>
                                <small style="color: #6b7280;">Confirmation: ${confirmation}</small>
                            </div>
                            <div>
                                <strong>Check-in:</strong><br>
                                <span style="color: #059669;">${formatDate(checkIn)}</span>
                            </div>
                            <div>
                                <strong>Check-out:</strong><br>
                                <span style="color: #dc2626;">${formatDate(checkOut)}</span>
                            </div>
                            <button class="btn" style="font-size: 12px; padding: 6px 12px;">Import</button>
                        </div>
                        <div style="margin-top: 10px; font-size: 14px; color: #6b7280;">
                            ${guestDisplay} ‚Ä¢ ${nights} nights
                        </div>
                    </div>
                `;
            });
            
            html += '</div>';
            document.getElementById('csv-data').innerHTML = html;
            
            // Store bookings for import
            window.parsedBookings = bookings;
        }

        function importBooking(index) {
            const booking = window.parsedBookings[index];
            
            // Map Airbnb CSV fields to our form fields
            const guestName = booking['Guest name'] || booking['Guest Name'] || booking['Guest'] || 'Unknown Guest';
            const checkIn = booking['Start date'] || booking['Check-in'] || booking['Checkin'] || booking['Check in'] || '';
            const checkOut = booking['End date'] || booking['Check-out'] || booking['Checkout'] || booking['Check out'] || '';
            const confirmation = booking['Confirmation code'] || booking['Confirmation Code'] || booking['Confirmation'] || `BK${Date.now()}`;
            
            // Better guest count calculation - try multiple field names
            let guestCount = 0;
            const adults = parseInt(booking['# of adults'] || booking['Adults'] || booking['Number of adults'] || 0);
            const children = parseInt(booking['# of children'] || booking['Children'] || booking['Number of children'] || 0);
            const infants = parseInt(booking['# of infants'] || booking['Infants'] || booking['Number of infants'] || 0);
            const totalGuests = parseInt(booking['Guests'] || booking['Guest count'] || booking['# of guests'] || booking['Total guests'] || 0);
            
            // Use total if available, otherwise calculate from breakdown
            if (totalGuests > 0) {
                guestCount = totalGuests;
            } else if (adults > 0 || children > 0 || infants > 0) {
                guestCount = adults + children + infants;
            } else {
                guestCount = 2; // Default fallback
            }
            
            // Generate new door code first
            const newDoorCode = Math.floor(1000 + Math.random() * 9000).toString();
            
            // Update form fields
            document.getElementById('admin-guest-name').value = guestName;
            document.getElementById('admin-guest-count').value = guestCount;
            document.getElementById('admin-checkin').value = formatDateForInput(checkIn);
            document.getElementById('admin-checkout').value = formatDateForInput(checkOut);
            document.getElementById('admin-confirmation').value = confirmation;
            document.getElementById('admin-door-code').value = newDoorCode;
            
            // DIRECTLY update guestData object
            guestData.guestName = guestName;
            guestData.guestCount = parseInt(guestCount); // Ensure it's a number
            guestData.confirmation = confirmation;
            guestData.doorCode = newDoorCode;
            
            // Store raw dates for admin form
            guestData.rawCheckIn = formatDateForInput(checkIn);
            guestData.rawCheckOut = formatDateForInput(checkOut);
            
            // Format dates for display
            if (checkIn) {
                guestData.checkIn = new Date(checkIn).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            }
            if (checkOut) {
                guestData.checkOut = new Date(checkOut).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
            }
            
            // Save to localStorage IMMEDIATELY
            try {
                localStorage.setItem('capeCoralGuestData', JSON.stringify(guestData));
                console.log('Imported guest data:', guestData); // Debug log
            } catch (error) {
                console.log('Could not save guest data');
            }
            
            // Update displays
            updateDisplays();
            
            showAlert(`Successfully imported: ${guestName} (${guestCount} guests) - Door code: ${newDoorCode}`, 'success');
            
            // Hide the import section
            document.getElementById('csv-preview').style.display = 'none';
            document.getElementById('parse-btn').style.display = 'none';
            document.getElementById('airbnb-csv').value = '';
        }

        function formatDate(dateStr) {
            if (!dateStr) return 'Not specified';
            try {
                const date = new Date(dateStr);
                return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
            } catch (e) {
                return dateStr;
            }
        }

        function formatDateForInput(dateStr) {
            if (!dateStr) return '';
            try {
                const date = new Date(dateStr);
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            } catch (e) {
                return '';
            }
        }

        function generateNewDoorCode() {
            const code = Math.floor(1000 + Math.random() * 9000).toString();
            document.getElementById('admin-door-code').value = code;
            showAlert(`New door code generated: ${code}`, 'info');
        }

        // Property Photo Upload Functions
        function uploadPropertyPhoto() {
            const fileInput = document.getElementById('property-photo');
            if (fileInput.files.length > 0) {
                const file = fileInput.files[0];
                const reader = new FileReader();
                
                reader.onload = function(e) {
                    const imageData = e.target.result;
                    
                    // Save to localStorage
                    try {
                        localStorage.setItem('propertyPhoto', imageData);
                        showAlert('Property photo uploaded successfully!', 'success');
                    } catch (error) {
                        showAlert('Photo file too large. Please use a smaller image.', 'error');
                        return;
                    }
                    
                    // Show preview in admin
                    displayPhotoPreview(imageData);
                    
                    // Update guest page
                    updatePropertyPhotoDisplay(imageData);
                };
                
                reader.readAsDataURL(file);
            }
        }

        function displayPhotoPreview(imageData) {
            const previewDiv = document.getElementById('photo-preview');
            previewDiv.innerHTML = `
                <div style="text-align: center;">
                    <img src="${imageData}" style="max-width: 300px; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);" alt="Property Photo Preview">
                    <p style="margin: 10px 0; color: #059669; font-weight: bold;">‚úÖ Photo uploaded successfully!</p>
                    <button class="btn btn-danger" onclick="removePropertyPhoto()" style="font-size: 12px; padding: 6px 12px;">Remove Photo</button>
                </div>
            `;
        }

        function updatePropertyPhotoDisplay(imageData) {
            const photoDisplay = document.getElementById('property-photo-display');
            photoDisplay.innerHTML = `
                <img src="${imageData}" style="width: 100%; max-width: 600px; height: auto; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1);" alt="Cape Coral Home Retreat - Your beautiful tropical property">
                <p class="small-text" style="margin-top: 10px; color: #6B7280;">Your beautiful tropical retreat in Cape Coral, Florida</p>
            `;
        }

        function removePropertyPhoto() {
            localStorage.removeItem('propertyPhoto');
            
            // Reset admin preview
            document.getElementById('photo-preview').innerHTML = '';
            document.getElementById('property-photo').value = '';
            
            // Reset guest display
            const photoDisplay = document.getElementById('property-photo-display');
            photoDisplay.innerHTML = `
                <div style="background: linear-gradient(135deg, #f0f9ff, #e0f2fe); padding: 40px 20px; border-radius: 12px; border: 2px dashed #00B4D8;">
                    <h3 style="color: #00B4D8; margin-bottom: 10px;">üèñÔ∏è Property Photo</h3>
                    <p style="color: #6B7280; margin: 0;">Upload a photo in the admin panel to showcase your beautiful property here!</p>
                </div>
            `;
            
            showAlert('Property photo removed', 'info');
        }

        function loadPropertyPhoto() {
            try {
                const savedPhoto = localStorage.getItem('propertyPhoto');
                if (savedPhoto) {
                    updatePropertyPhotoDisplay(savedPhoto);
                    displayPhotoPreview(savedPhoto);
                }
            } catch (error) {
                console.log('No saved property photo found');
            }
        }

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Load saved guest data
            try {
                const savedGuestData = localStorage.getItem('capeCoralGuestData');
                if (savedGuestData) {
                    guestData = { ...guestData, ...JSON.parse(savedGuestData) };
                }
            } catch (error) {
                console.log('No saved guest data found, using defaults');
            }
            
            // Update displays with loaded data
            updateDisplays();
            
            // Improved admin toggle with Ctrl+Shift+A
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.shiftKey && e.key === 'A') {
                    const adminBtn = document.getElementById('admin-btn');
                    if (adminBtn.style.display === 'none' || adminBtn.style.display === '') {
                        adminBtn.style.display = 'inline-block';
                        showAlert('Admin access enabled', 'success');
                    } else {
                        adminBtn.style.display = 'none';
                        // If currently in admin mode, logout
                        if (document.getElementById('admin-nav').style.display === 'flex') {
                            logout();
                        }
                        showAlert('Admin access hidden', 'info');
                    }
                    e.preventDefault();
                }
            });
            
            showPage('home');
            const firstBtn = document.querySelector('.btn');
            if (firstBtn) firstBtn.classList.add('active');
        });

        // Add CSS animation
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
